name: Get version from pom.xml - env
 
on: [push]

defaults:
 run:
  working-directory: example1-gitactions

jobs:
 get-version-env:
    runs-on: ubuntu-latest
    env: 
       RELEASE_VERSION: ${{ env.RELEASE_VERSION }}
 
    steps:

      - uses: actions/checkout@v2

      - name: Set up JDK 1.11
        uses: actions/setup-java@v1
        with:
          java-version: 1.11
         
      - name: Extract Maven project version
        run: echo "RELEASE_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)" >> $GITHUB_ENV

      - name: Show extracted  Maven project version
        run: echo "Version is ${{ env.RELEASE_VERSION }}"
       
 use-version:
    needs: get-version-env
    runs-on: ubuntu-latest
 
    steps:
      - uses: actions/checkout@v2

      - name: Set up JDK 1.11
        uses: actions/setup-java@v1
        with:
          java-version: 1.11
          
      - name: Show extracted  Maven project version
        run: echo "Version is ${{ needs.get-version-env.env.RELEASE_VERSION }}"